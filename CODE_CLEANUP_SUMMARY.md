# ä»£ç å†—ä½™æ¸…ç†æ€»ç»“

## ğŸ§¹ å·²æ¸…ç†çš„å†—ä½™ä»£ç 

### 1. é‡å¤çš„æµ‹è¯•æ–‡ä»¶
**åˆ é™¤çš„æ–‡ä»¶:**
- `test-fetch.js` - å°çº¢ä¹¦é¡µé¢è§£ææµ‹è¯•
- `fetch-xhs-test.js` - å°çº¢ä¹¦é¡µé¢è§£ææµ‹è¯•ï¼ˆåŠŸèƒ½é‡å¤ï¼‰
- `test-new-parser.js` - æ–°è§£æAPIæµ‹è¯•
- `test-meta-parsing.js` - Metaæ ‡ç­¾è§£ææµ‹è¯•

**æ›¿æ¢ä¸º:**
- `test-xhs-unified.js` - ç»Ÿä¸€çš„å°çº¢ä¹¦è§£ææµ‹è¯•å¥—ä»¶

### 2. é‡å¤çš„å·¥å…·å‡½æ•°
**åˆ›å»ºäº†ç»Ÿä¸€çš„å·¥å…·æ¨¡å—:**
- `packages/backend/utils/normalize.js` - ç»Ÿä¸€çš„æ•°å­—æ ‡å‡†åŒ–å·¥å…·

**æ›´æ–°çš„æ–‡ä»¶:**
- `packages/backend/routes/daren.js` - ä½¿ç”¨ç»Ÿä¸€çš„å·¥å…·å‡½æ•°
- `packages/backend/scripts/normalize-numeric-data.js` - ä½¿ç”¨ç»Ÿä¸€çš„å·¥å…·å‡½æ•°

### 3. å†—ä½™çš„HTMLæµ‹è¯•æ–‡ä»¶
**åˆ é™¤çš„æ–‡ä»¶:**
- `xhs_note.html`
- `xhs_note_with_cookie.html`

**ä¿ç•™çš„æ–‡ä»¶:**
- `xhs_page_raw.html` - ä½œä¸ºå‚è€ƒä¿ç•™

## ğŸ“Š æ¸…ç†æ•ˆæœ

### æ–‡ä»¶æ•°é‡å‡å°‘
- åˆ é™¤äº† 6 ä¸ªå†—ä½™æ–‡ä»¶
- æ–°å¢äº† 2 ä¸ªç»Ÿä¸€çš„å·¥å…·æ–‡ä»¶
- å‡€å‡å°‘ 4 ä¸ªæ–‡ä»¶

### ä»£ç é‡å¤æ¶ˆé™¤
- `normalizeNumber` å‡½æ•°ä» 5 ä¸ªåœ°æ–¹é‡å¤å®šä¹‰å‡å°‘åˆ° 1 ä¸ªç»Ÿä¸€å®šä¹‰
- æµ‹è¯•é€»è¾‘ä» 4 ä¸ªåˆ†æ•£æ–‡ä»¶æ•´åˆåˆ° 1 ä¸ªç»Ÿä¸€æµ‹è¯•å¥—ä»¶
- å‡å°‘äº†çº¦ 500+ è¡Œé‡å¤ä»£ç 

## ğŸ”§ æ–°çš„ç»Ÿä¸€å·¥å…·

### 1. æ•°å­—æ ‡å‡†åŒ–å·¥å…· (`packages/backend/utils/normalize.js`)
```javascript
// ç»Ÿä¸€çš„æ•°å­—æ ‡å‡†åŒ–å‡½æ•°
normalizeNumber(value)

// ç»Ÿä¸€çš„è¾¾äººæ•°æ®æ ‡å‡†åŒ–å‡½æ•°
normalizeDarenData(data)
```

### 2. ç»Ÿä¸€æµ‹è¯•å¥—ä»¶ (`test-xhs-unified.js`)
```javascript
// åŒ…å«æ‰€æœ‰è§£ææµ‹è¯•åŠŸèƒ½çš„ç»Ÿä¸€æµ‹è¯•ç±»
class XhsTestSuite {
  testDirectParsing()    // ç›´æ¥é¡µé¢è§£æ
  testApiEndpoints()     // APIç«¯ç‚¹æµ‹è¯•
  testMetaParsing()      // Metaæ ‡ç­¾è§£æ
  testHtmlFallback()     // HTMLå›é€€è§£æ
}
```

## âš ï¸ ä»éœ€æ³¨æ„çš„ä¾èµ–é‡å¤

### åŒ…ä¾èµ–é‡å¤
ä»¥ä¸‹ä¾èµ–åœ¨å¤šä¸ª package.json ä¸­é‡å¤å®šä¹‰ï¼Œå»ºè®®ä¼˜åŒ–ï¼š

**æ ¹ç›®å½• vs Backend:**
- `axios`: æ ¹ç›®å½• ^1.10.0, Backend ^1.7.2
- `mongoose`: æ ¹ç›®å½• ^8.16.4, Backend ^8.5.1
- `cheerio`: æ ¹ç›®å½• ^1.1.0, Backend ^1.0.0-rc.12

**å»ºè®®:** 
- å°†å…±äº«ä¾èµ–æå‡åˆ°æ ¹ç›®å½•çš„ workspaces
- æˆ–è€…ç§»é™¤æ ¹ç›®å½•ä¸­çš„é‡å¤ä¾èµ–ï¼Œåªåœ¨éœ€è¦çš„åŒ…ä¸­å®šä¹‰

## ğŸ¯ åç»­ä¼˜åŒ–å»ºè®®

1. **ä¾èµ–ç®¡ç†ä¼˜åŒ–**
   - ç»Ÿä¸€ç‰ˆæœ¬å·
   - ä½¿ç”¨ workspace ä¾èµ–æå‡

2. **æµ‹è¯•ç»“æ„ä¼˜åŒ–**
   - å°†æµ‹è¯•æ–‡ä»¶ç§»åˆ° `tests/` ç›®å½•
   - æ·»åŠ  Jest æˆ–å…¶ä»–æµ‹è¯•æ¡†æ¶

3. **å·¥å…·å‡½æ•°æ‰©å±•**
   - è€ƒè™‘æ·»åŠ æ›´å¤šé€šç”¨å·¥å…·å‡½æ•°åˆ° `utils/` ç›®å½•
   - åˆ›å»ºå‰åç«¯å…±äº«çš„å·¥å…·åº“

4. **æ–‡æ¡£æ•´ç†**
   - æ¸…ç†è¿‡æ—¶çš„æ–‡æ¡£æ–‡ä»¶
   - æ›´æ–° README ä¸­çš„æµ‹è¯•è¯´æ˜

## âœ… éªŒè¯æ¸…ç†æ•ˆæœ

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ¸…ç†åçš„ä»£ç ï¼š

```bash
# æµ‹è¯•åç«¯åŠŸèƒ½
cd packages/backend
node server.js

# è¿è¡Œç»Ÿä¸€æµ‹è¯•å¥—ä»¶
node test-xhs-unified.js

# æµ‹è¯•æ•°å­—æ ‡å‡†åŒ–
node -e "const {normalizeNumber} = require('./packages/backend/utils/normalize'); console.log(normalizeNumber('1.2ä¸‡'));"
```

æ¸…ç†å®Œæˆï¼ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œç»´æŠ¤æ€§æ˜¾è‘—æå‡ã€‚